webpackJsonp([16],{"7XV+":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("wSez"),a={name:"Product",data:function(){return{flag:!1,selected:"1",isUnscRollable:!1,backParentPage:!1,screensLists:[{name:"分类"},{name:"品牌"},{name:"价格"},{name:"筛选"}],showLayer:!1,clickNum:{1:{name:"分类",isCur:!1,isData:!1},2:{name:"品牌",isCur:!1,isData:!1},3:{name:"价格",isCur:!1,isData:!1},4:{name:"筛选",isCur:!1,isData:!1}},curScreen:"",list:[],page:1,searchCon:this.$route.query.searchCon,loading:!1,showLoadMore:!1,isImported:"",jx:[{id:1,jxName:"粉剂"},{id:2,jxName:"贴剂"},{id:3,jxName:"口服散剂"},{id:4,jxName:"外用液体剂"},{id:5,jxName:"软膏剂"},{id:6,jxName:"栓剂"},{id:7,jxName:"口服液"},{id:8,jxName:"颗粒"},{id:9,jxName:"片剂"},{id:10,jxName:"胶囊"}],isJx:"",jxName:"",brandList:[],curBrandIndex:"",curBrandId:"",minPrice:"",maxPrice:"",ks:[],curKs:0,childSort:[],parentName:"",curRightSort:"",productTypeID:this.$route.query.ptId?this.$route.query.ptId:"",parentTypeId:this.$route.query.ptIdOne?this.$route.query.ptIdOne:"",showLoadAnimate:!1}},components:{"mt-field":i.Field,"mt-header":i.Header,"mt-button":i.Button,"mt-tab-container":i.TabContainer,"mt-tab-container-item":i.TabContainerItem,"mt-cell":i.Cell,"mt-popup":i.Popup,"mt-radio":i.Radio,"mt-spinner":i.Spinner},filters:{imgType:function(t){return 1==t?"RX":2==t?"OTC-2":3==t?"OTC-1":void 0},priceFilter:function(t){return"￥"+Number(t).toFixed(2)}},created:function(){},mounted:function(){this.$emit("changeClass",!1)},destroyed:function(){this.$emit("changeClass",!0)},methods:{loadMore:function(){var t=this;if(this.flag||this.isUnscRollable)return!1;this.loading=!0,this.showLoadMore=!0,t.flag=!0,setTimeout(function(){t.$ajax({url:t.webRoot+"/product/getProductList",data:{page:t.page,limit:20,productName:t.searchCon,isImport:t.isImported,productDrugType:t.jxName,brandId:t.curBrandId,lowestPrice:t.minPrice,highest:t.maxPrice,productType_one:t.parentTypeId,productType_two:t.productTypeID,sysNo:"wap"}}).then(function(e){if(e.data.success){if(0==e.data.data.length)return t.showLoadMore=!1,t.loading=!0,t.flag=!1,!1;for(var s=0;s<e.data.data.length;s++)t.list.push(e.data.data[s]);t.loading=!1,t.showLoadMore=!1,t.page++,t.flag=!1}else t.$options.methods.showToast(e.data.msg),t.showLoadMore=!1,t.loading=!0,t.flag=!1}).catch(function(t){console.log(t)})},300)},chooseBrand:function(t,e){this.curBrandIndex=e,this.curBrandId=t.brandID},clickScreens:function(t,e){var s=this;if(this.curScreen==e+1)return this.clickNum[e+1].isData||(this.clickNum[e+1].isCur=!1),this.curScreen="",this.isUnscRollable=!1,this.showLayer=!1,!1;for(var i in this.clickNum[e+1].isData||(this.clickNum[e+1].isCur=!1),this.curScreen="",this.isUnscRollable=!1,this.showLayer=!1,this.clickNum)this.clickNum[i].isData||(this.clickNum[i].isCur=!1);if(this.isUnscRollable=!0,this.clickNum[e+1].isCur=!0,0==e){if(this.curScreen=1,this.showLayer=!0,this.ks.length>0)return;this.$ajax({url:s.webRoot+"/productType/getAllOneLevelProductType"}).then(function(t){s.ks=t.data,s.$ajax({url:s.webRoot+"/productType/getAllTwoLevelProductType",data:{parentTypeID:""}}).then(function(t){for(var e=[],i=0;i<t.data.length;i++)0!=t.data[i].parentTypeID&&e.push(t.data[i]);s.parentName="",s.childSort=e})})}else 1==e?(this.$ajax({url:s.webRoot+"/brand/getBrandList"}).then(function(t){if(t.data.success){if(0==t.data.data.length)return s.$options.methods.showToast("没有更多数据!"),!1;s.brandList=t.data.data}}).catch(function(t){console.log(t)}),this.curScreen=2,this.showLayer=!0):2==e?(this.curScreen=3,this.showLayer=!0):3==e&&(this.curScreen=4)},btnImport:function(t){this.isImported=1==t?1:0},btnJx:function(t,e){this.isJx=t.id},resetSolt:function(){this.isImported=this.isJx=this.jxName="",this.page=1,this.$options.methods.getProduct(this)},confirmSolt:function(){if(""===this.isImported&&""===this.isJx)return!1;for(var t in this.jx)if(t==this.isJx-1){this.jxName=this.jx[this.isJx-1].jxName;break}this.page=1,this.$options.methods.getData(this),this.clickNum[4].isCur=this.clickNum[4].isData=!0},resetBrand:function(){this.curBrandIndex=this.curBrandId="",this.page=1,this.$options.methods.getProduct(this),this.$options.methods.ComCloseLayer(this)},confirmBrand:function(){if(""===this.curBrandIndex&&""===this.curBrandId)return!1;this.$options.methods.getData(this),this.clickNum[2].isCur=this.clickNum[2].isData=!0},confirmPrice:function(){var t=/^\d+$/;return t.test(this.minPrice)&&t.test(this.maxPrice)?this.minPrice>=this.maxPrice?(this.$options.methods.showToast("请填写正确的价格区间!"),!1):(this.$options.methods.getData(this),void(this.clickNum[3].isCur=this.clickNum[3].isData=!0)):(this.$options.methods.showToast("请填写正确的价格区间!"),!1)},nextSort:function(t,e){var s=this,i=t.productTypeID;if(this.curRightSort="",this.productTypeID="",this.curKs=e+1,"allSort"==t)return this.curKs=0,i="",this.$ajax({url:s.webRoot+"/productType/getAllTwoLevelProductType",data:{parentTypeID:i}}).then(function(t){for(var e=[],i=0;i<t.data.length;i++)0!=t.data[i].parentTypeID&&e.push(t.data[i]);s.parentName="",s.childSort=e}),!1;this.$ajax({url:s.webRoot+"/productType/getAllTwoLevelProductType",data:{parentTypeID:i}}).then(function(e){s.parentName=t.productTypeName,s.childSort=e.data})},searchSort:function(t,e){var s="";if(this.curRightSort=e+1,this.productTypeID=t.productTypeID,"allSort"==t){if(this.curRightSort=0,0===this.curKs)return this.curRightSort=0,this.parentTypeId=this.productTypeID="",this.$options.methods.getData(this),this.clickNum[1].isCur=this.clickNum[1].isData=!1,!1;s=this.ks[this.curKs-1].productTypeID,this.parentTypeId=s}this.$options.methods.getData(this),this.clickNum[1].isCur=this.clickNum[1].isData=!0},jumpSearch:function(){this.productTypeID?this.$router.replace({path:"/search",query:{hotByIdTwo:this.productTypeID}}):this.parentTypeId?this.$router.replace({path:"/search",query:{hotByIdOne:this.parentTypeId}}):this.$router.replace({path:"/search"})},jumpDetail:function(t,e){this.$router.push({path:"/product_detail",query:{proid:t.productID}})},closeLayer:function(){for(var t in this.isUnscRollable=!1,this.clickNum)this.clickNum[t].isData||(this.clickNum[t].isCur=!1);this.curScreen="",this.showLayer=!1},ComCloseLayer:function(t){for(var e in t.isUnscRollable=!1,t.clickNum)t.clickNum[e].isData||(t.clickNum[e].isCur=!1);t.curScreen="",t.showLayer=!1},goBack:function(){this.$router.go(-1)},btnSave:function(){console.log("点击确定")},getData:function(t){t.page=1,t.showLoadAnimate=!0,t.$options.methods.getProduct(t),t.curScreen="",t.isUnscRollable=!1,t.showLayer=!1},getProduct:function(t){var e=t.parentTypeId;if(t.flag)return!1;e||(e=""),t.flag=!0,t.$ajax({url:t.webRoot+"/product/getProductList",data:{page:t.page,limit:20,productName:t.searchCon,isImport:t.isImported,productDrugType:t.jxName,brandId:t.curBrandId,lowestPrice:t.minPrice,highest:t.maxPrice,productType_one:e,productType_two:t.productTypeID,sysNo:"wap"}}).then(function(e){e.data.success?(0==e.data.data.length&&t.$options.methods.showToast("没有更多数据!"),t.list=[],setTimeout(function(){t.list=e.data.data},1e3)):t.$options.methods.showToast(e.data.msg),t.flag=!1,setTimeout(function(){t.showLoadAnimate=!1},1e3)}).catch(function(t){console.log(t)})},showToast:function(t,e){e=e||2e3;Object(i.Toast)({message:t,position:"center",duration:e})},changeClassOne:function(t){t?(this.backParentPage=!0,this.isUnscRollable=!1):(this.backParentPage=!1,this.isUnscRollable=!0)}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"wrap has_header_wrap"},[s("section",{staticClass:"wrap_in",class:{unscrollable:t.isUnscRollable}},[s("div",{staticClass:"product_in"},[s("div",{staticClass:"search_top"},[s("form",{staticClass:"d_flex",attrs:{action:"javascript:;"},on:{click:t.jumpSearch}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchCon,expression:"searchCon"}],attrs:{type:"text",placeholder:"请输入搜索内容"},domProps:{value:t.searchCon},on:{input:function(e){e.target.composing||(t.searchCon=e.target.value)}}}),t._v(" "),s("button",[t._v("搜索")])])]),t._v(" "),s("div",{staticClass:"screens"},[s("div",{staticClass:"lists d_flex"},t._l(t.screensLists,function(e,i){return s("a",{class:[i==t.screensLists.length-1?"screen_a":"",{cur:t.clickNum[i+1].isCur}],attrs:{href:"javascript:;"},on:{click:function(s){t.clickScreens(e,i)}}},[t._v("\r\n\t\t\t\t\t\t"+t._s(e.name)+"\r\n\t\t\t\t\t\t"),s("i")])})),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1===t.curScreen,expression:"curScreen===1"}],staticClass:"all_solt d_flex"},[s("div",{staticClass:"left"},[s("dl",[s("dd",{class:{cur:0===t.curKs},on:{click:function(e){t.nextSort("allSort",0)}}},[t._v("全部分类")]),t._v(" "),t._l(t.ks,function(e,i){return s("dd",{class:{cur:i+1==t.curKs},on:{click:function(s){t.nextSort(e,i)}}},[t._v(t._s(e.productTypeName))])})],2)]),t._v(" "),s("div",{staticClass:"right"},[s("dl",[s("dd",{class:{cur:0===t.curRightSort},on:{click:function(e){t.searchSort("allSort",0)}}},[t._v("全部"+t._s(t.parentName))]),t._v(" "),t._l(t.childSort,function(e,i){return s("dd",{class:{cur:i+1===t.curRightSort},on:{click:function(s){t.searchSort(e,i)}}},[t._v("\r\n\t\t\t\t\t\t\t\t\t"+t._s(e.productTypeName)+"\r\n\t\t\t\t\t\t\t\t\t")])})],2)])])]),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.curScreen,expression:"curScreen===2"}],staticClass:"brand_solt"},[s("div",{staticClass:"top"},t._l(t.brandList,function(e,i){return s("a",{class:{cur:t.curBrandIndex===i},attrs:{href:"javascript:;"},on:{click:function(s){t.chooseBrand(e,i)}}},[t._v(t._s(e.brandName))])})),t._v(" "),s("div",{staticClass:"bottom d_flex"},[s("button",{on:{click:t.resetBrand}},[t._v("重置")]),t._v(" "),s("button",{on:{click:t.confirmBrand}},[t._v("确定")])])])]),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:3===t.curScreen,expression:"curScreen===3"}],staticClass:"brand_solt price_solt"},[t._e(),t._v(" "),s("div",{staticClass:"center"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.minPrice,expression:"minPrice",modifiers:{trim:!0}}],attrs:{type:"number",placeholder:"最低价"},domProps:{value:t.minPrice},on:{input:function(e){e.target.composing||(t.minPrice=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),s("span",[t._v("元")]),t._v(" "),s("span",[t._v("~")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.maxPrice,expression:"maxPrice",modifiers:{trim:!0}}],attrs:{type:"number",placeholder:"最高价"},domProps:{value:t.maxPrice},on:{input:function(e){e.target.composing||(t.maxPrice=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),s("span",[t._v("元")])]),t._v(" "),s("div",{staticClass:"bottom d_flex"},[s("button",{on:{click:t.confirmPrice}},[t._v("确定")])])])])],1),t._v(" "),s("div",{staticClass:"product_lists"},[s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"400"}},t._l(t.list,function(e,i){return s("li",{staticClass:"d_flex",on:{click:function(s){t.jumpDetail(e,i)}}},[s("div",{staticClass:"list_img"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.defaultPhoto,expression:"lt.defaultPhoto"}],attrs:{alt:e.productName}})]),t._v(" "),s("div",{staticClass:"list_info"},[s("h2",[s("i",{directives:[{name:"show",rawName:"v-show",value:e.prescriptionType,expression:"lt.prescriptionType"}],class:t._f("imgType")(e.prescriptionType)}),t._v(t._s(e.productName))]),t._v(" "),s("span",[t._v(t._s(e.spec))]),t._v(" "),s("h3",{staticClass:"r_color"},[t._v(t._s(t._f("priceFilter")(e.ourPrice)))]),t._v(" "),t._e()])])})),t._v(" "),s("div",{staticClass:"icon_loading"},[s("span",{directives:[{name:"show",rawName:"v-show",value:!t.showLoadMore,expression:"!showLoadMore"}]},[t._v("没有更多了")]),t._v(" "),s("mt-spinner",{directives:[{name:"show",rawName:"v-show",value:t.showLoadMore,expression:"showLoadMore"}],attrs:{type:"triple-bounce"}})],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:4===t.curScreen,expression:"curScreen===4"}],staticClass:"detail_solt",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeLayer(e)}}},[s("div",{staticClass:"top"},[s("div",{staticClass:"item"},[t._m(0),t._v(" "),s("ul",[s("li",{class:{cur:1===t.isImported},on:{click:function(e){t.btnImport(1)}}},[t._v("是")]),t._v(" "),s("li",{class:{cur:0===t.isImported},on:{click:function(e){t.btnImport(0)}}},[t._v("否")])])]),t._v(" "),s("div",{staticClass:"item"},[t._m(1),t._v(" "),s("ul",t._l(t.jx,function(e,i){return s("li",{class:{cur:t.isJx===i+1},on:{click:function(s){t.btnJx(e,i)}}},[t._v(t._s(e.jxName))])}))]),t._v(" "),s("div",{staticClass:"btns d_flex"},[s("button",{on:{click:t.resetSolt}},[t._v("重置")]),t._v(" "),s("button",{on:{click:t.confirmSolt}},[t._v("确定")])])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showLoadAnimate,expression:"showLoadAnimate"}],attrs:{id:"loadAnimate"}},[s("div",[s("mt-spinner",{attrs:{type:"snake",color:"#fff"}})],1)]),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showLayer,expression:"showLayer"}],staticClass:"layer",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeLayer(e)}}})])],1)]),t._v(" "),s("transition",{attrs:{name:"fade"}},[s("router-view",{on:{changeClass:t.changeClassOne}})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{staticClass:"cur"},[e("span",[this._v("是否进口")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{staticClass:"cur"},[e("span",[this._v("剂型")])])}]};var o=s("vSla")(a,r,!1,function(t){s("oQco")},"data-v-e77f63a6",null);e.default=o.exports},oQco:function(t,e){}});
//# sourceMappingURL=16.719bdc3935ec3f1ab1de.js.map