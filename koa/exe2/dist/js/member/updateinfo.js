$(function(){var d=d||function(o,e){var t={},i=t.lib={},n=function(){},r=i.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=i.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var r=0;r<e;r++)t[n+r>>>2]|=(i[r>>>2]>>>24-r%4*8&255)<<24-(n+r)%4*8;else if(65535<i.length)for(r=0;r<e;r+=4)t[n+r>>>2]=i[r>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=o.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],i=0;i<e;i+=4)t.push(4294967296*o.random()|0);return new c.init(t,e)}}),a=t.enc={},s=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++){var r=t[n>>>2]>>>24-n%4*8&255;i.push((r>>>4).toString(16)),i.push((15&r).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new c.init(i,t/2)}},l=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new c.init(i,t)}},u=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,i=t.words,n=t.sigBytes,r=this.blockSize,a=n/(4*r);if(e=(a=e?o.ceil(a):o.max((0|a)-this._minBufferSize,0))*r,n=o.min(4*e,n),e){for(var s=0;s<e;s+=r)this._doProcessBlock(i,s);s=i.splice(0,e),t.sigBytes-=n}return new c.init(s,n)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=f.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(i){return function(e,t){return new i.init(t).finalize(e)}},_createHmacHelper:function(i){return function(e,t){return new d.HMAC.init(i,t).finalize(e)}}});var d=t.algo={};return t}(Math);!function(r){for(var e=d,t=(n=e.lib).WordArray,i=n.Hasher,n=e.algo,a=[],g=[],s=function(e){return 4294967296*(e-(0|e))|0},o=2,c=0;c<64;){var l;e:{l=o;for(var u=r.sqrt(l),f=2;f<=u;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(c<8&&(a[c]=s(r.pow(o,.5))),g[c]=s(r.pow(o,1/3)),c++),o++}var h=[];n=n.SHA256=i.extend({_doReset:function(){this._hash=new t.init(a.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],a=i[2],s=i[3],o=i[4],c=i[5],l=i[6],u=i[7],f=0;f<64;f++){if(f<16)h[f]=0|e[t+f];else{var d=h[f-15],p=h[f-2];h[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+h[f-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+h[f-16]}d=u+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&c^~o&l)+g[f]+h[f],p=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&r^n&a^r&a),u=l,l=c,c=o,o=s+d|0,s=a,a=r,r=n,n=d+p|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+a|0,i[3]=i[3]+s|0,i[4]=i[4]+o|0,i[5]=i[5]+c|0,i[6]=i[6]+l|0,i[7]=i[7]+u|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=r.floor(i/4294967296),t[15+(n+64>>>9<<4)]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA256=i._createHelper(n),e.HmacSHA256=i._createHmacHelper(n)}(Math);var e=$.getGlobalVal().webRoot,n=$.getGlobalVal().memberId,r=($.getGlobalVal().webOrigin,$.getGlobalVal().curDate,$.getGlobalVal().curDay),a=($.getGlobalVal().ImgSrc,"");$.ajax({url:"/vipSearchByID",type:"POST",dataType:"json",ansyc:!1,data:{id:n}}).done(function(i){if(i){(new Date).getHours();$('.info_name input[name="userName"]').val(i.memberName),i.sex?"男"==i.sex?$("#male").prop({checked:!0}):$("#female").prop({checked:!0}):$("#unSet").prop({checked:!0}),a=i.birthday,layui.use("laydate",function(){var e=layui.laydate,t="";t=i.birthday?i.birthday:r,e.render({elem:"#birInput",value:t,max:r,done:function(e,t){a=e}})}),i.picURL&&($(".info_right .ir_upImg .img").append('<img class="lazy" data-original="'+i.picURL+'">'),lazyLoad({imgSrc:"/static/images/myImg.png"}))}}),$(".ir_upImg .img").on("click","img",function(e){e.preventDefault(),$("#upload_img_btn").trigger("click")});var t=d.SHA256(n+"akjk"),i=new plupload.Uploader({browse_button:"upload_img_btn",url:e+"/upLoadByMemberId",multipart:!0,multi_selection:!1,file_data_name:"file",multipart_params:{memberID:n},headers:{Authorization:t.toString(d.enc.Base64)},resize:{crop:!0,quality:60,preserve_headers:!0},filters:{mime_types:[{title:"Image files",extensions:"jpg,jpeg,png"}],max_file_size:"1024kb"}});i.init(),i.bind("FilesAdded",function(e,t){var i=t[0].getNative(),n=new FileReader,r=new Image;n.readAsDataURL(i),n.onload=function(){r.src=this.result},$(".user_img_con").html(""),$(".user_img_con").append(r),$(".user_img_layer").stop(!0,!0).fadeIn(300)}),i.bind("BeforeUpload",function(e,t){}),i.bind("UploadFile",function(e,t){}),i.bind("UploadProgress",function(e,t){t.percent;$(".user_img_in .img_load_layer").css("display","block")}),i.bind("FileUploaded",function(e,r,t){$(".user_img_in .img_load_layer").css("display","none");var a=JSON.parse(t.response);layui.use("layer",function(){var e=layui.layer;if(a.success){var t=r.getNative(),i=new FileReader,n=new Image;i.readAsDataURL(t),i.onload=function(){n.src=this.result},$(".ir_upImg .img").html(""),$(".ir_upImg .img").append(n),e.msg("头像上传成功!")}else e.msg("头像上传失败!");$(".user_img_layer").stop(!0,!0).fadeOut(300)})}),i.bind("Error",function(e,t){layui.use("layer",function(){var e=layui.layer;"-600"==t.code?e.msg("头像上传失败，请选择小于1M的图片！"):e.msg("头像上传失败，"+t.message)})}),$(".user_img_options .bp_green").click(function(e){i.start()}),$(".user_img_options .bp_default").click(function(e){$(".user_img_layer").stop(!0,!0).fadeOut(300)}),$("#upload_img_btn").change(function(e){console.log("改变： ",e)}),$(".btn_comfirm").click(function(e){var i=$('.info_name input[name="userName"]').val(),t=$("input[name=sex]:checked").val();$.ajax({url:"/updateByMemberId",dataType:"json",data:{memberID:n,memberName:i,sex:t,birthday:a}}).done(function(t){layui.use("layer",function(){var e=layui.layer;t.success?($(".shortcut .isLogin .login").text(i),e.msg("修改成功！")):e.msg(t.msg)})})})});